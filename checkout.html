<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>إتمام الطلب — Neo Café</title>
<style>
  :root{
    --bg:#f7f7f7;
    --card:#fff;
    --accent:#125433;
    --muted:#666;
    --radius:12px;
    --shadow: 0 8px 28px rgba(0,0,0,0.06);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family: "Cairo", "Segoe UI", Tahoma, Arial;direction:rtl;background:var(--bg);color:#111;padding:18px}
  .wrap{max-width:720px;margin:12px auto}
  .card{background:var(--card);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow)}
  h1{margin:0 0 8px;font-size:22px;color:var(--accent)}
  label{display:block;font-weight:700;margin:12px 0 6px}
  .input, select, textarea{
    width:100%;padding:12px;border-radius:10px;border:1px solid #e6e6e6;font-size:15px;background:#fff;
  }
  textarea{min-height:120px;resize:vertical}
  .row{display:flex;gap:12px;align-items:center}
  /* date selects row: horizontal */
  .date-row{display:flex;gap:12px;align-items:center;margin-top:6px}
  .date-row .col{flex:1;min-width:0}
  .date-row select{width:100%}
  /* make sure on very small screens they still fit - allow horizontal scroll if needed */
  @media(max-width:420px){
    .date-row{gap:8px}
    .date-row .col{min-width:90px}
  }

  .actions{display:flex;gap:12px;align-items:center;justify-content:flex-start;margin-top:16px;flex-wrap:wrap}
  .btn{background:var(--accent);color:#fff;border:0;padding:12px 16px;border-radius:10px;cursor:pointer;font-weight:700}
  .btn.ghost{background:#fff;border:1px solid #ddd;color:#333}
  .note{background:#fff6e8;border-left:4px solid #f3d5a6;padding:10px;border-radius:8px;margin-top:12px;color:#5a4b2a}
  .small{font-size:13px;color:var(--muted);margin-top:8px}

  /* responsive tweaks */
  @media(max-width:600px){
    .row{flex-direction:column;align-items:stretch}
    .actions{justify-content:stretch}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="form" aria-labelledby="formTitle">
      <h1 id="formTitle">Neo Café — إتمام الطلب</h1>

      <!-- اسم الشهرة -->
      <label for="nickname">اسم الشهره</label>
      <input id="nickname" class="input" type="text" placeholder="اكتب اسم الشهرة اللي تحب يظهر " autocomplete="nickname">

      <!-- تاريخ الميلاد -->
      <label for="birth">تاريخ الميلاد</label>
      <div class="date-row" aria-labelledby="birth">
        <div class="col">
          <label class="sr-only" for="birth-day">اليوم</label>
          <select id="birth-day" aria-label="يوم الميلاد">
            <option value="">اليوم</option>
            <!-- أيام تُملأ ديناميكياً -->
          </select>
        </div>

        <div class="col">
          <label class="sr-only" for="birth-month">الشهر</label>
          <select id="birth-month" aria-label="شهر الميلاد">
            <option value="">الشهر</option>
            <!-- أشهر تُملأ ديناميكياً -->
          </select>
        </div>

        <div class="col">
          <label class="sr-only" for="birth-year">السنة</label>
          <select id="birth-year" aria-label="سنة الميلاد">
            <option value="">السنة</option>
            <!-- سنوات تُملأ ديناميكياً -->
          </select>
        </div>
      </div>

      <!-- رقم الطاولة -->
      <label for="table">رقم الطاولة</label>
      <select id="table" class="input">
        <option value="">اختر رقم الطاولة</option>
        <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
        <option>6</option><option>7</option><option>8</option><option>9</option><option>10</option>
      </select>

      <!-- رقم الهاتف -->
      <label for="phone">رقم الهاتف (مهم لنظام الولاء)</label>
      <input id="phone" class="input" type="tel" placeholder="010xxxxxxxx" inputmode="tel" pattern="[0-9]*">

      <div class="note" role="note">
        <strong>نظام الولاء:</strong> كل مرة تطلب فيها من نيو كافية وتحط رقم موبايلك تسجّل نقطة (ختمة). بعد 5 نقاط ستحصل على مشروب مجاني من اختيارك. فقط استخدم نفس رقم الموبايل وسيُحتسب لك التقدّم — لا حاجة لاشتراك أو تسجيل إضافي.
      </div>

      <!-- ملاحظات اضافية -->
      <label for="notes">ملاحظات إضافية (اختياري)</label>
      <textarea id="notes" placeholder="مثال: بدون سكر، زيادة حليب..."></textarea>

      <!-- الأزرار -->
      <div class="actions">
        <button id="submitBtn" class="btn">ارسل الطلب عبر واتساب</button>
        <button id="clearBtn" class="btn ghost" type="button">افراغ الحقول</button>
      </div>

      <div class="small">ملاحظة: تأكد من إدخال رقم الهاتف الصحيح لاستلام إشعارات الطلب ونظام الولاء.</div>
    </div>
  </div>

<script>
  // populate day/month/year selects
  (function populateDateInputs(){
    const daySel = document.getElementById('birth-day');
    const monthSel = document.getElementById('birth-month');
    const yearSel = document.getElementById('birth-year');

    // days 1..31
    for(let d=1; d<=31; d++){
      const opt = document.createElement('option');
      opt.value = String(d).padStart(2,'0');
      opt.textContent = d;
      daySel.appendChild(opt);
    }

    // months (Arabic names) mapped to numbers
    const months = [
      {n:1, name:'يناير'},
      {n:2, name:'فبراير'},
      {n:3, name:'مارس'},
      {n:4, name:'أبريل'},
      {n:5, name:'مايو'},
      {n:6, name:'يونيو'},
      {n:7, name:'يوليو'},
      {n:8, name:'أغسطس'},
      {n:9, name:'سبتمبر'},
      {n:10, name:'أكتوبر'},
      {n:11, name:'نوفمبر'},
      {n:12, name:'ديسمبر'},
    ];
    months.forEach(m=>{
      const opt = document.createElement('option');
      opt.value = String(m.n).padStart(2,'0');
      opt.textContent = `${m.name} (${m.n})`;
      monthSel.appendChild(opt);
    });

    // years: from current year down to 1960
    const currentYear = new Date().getFullYear();
    for(let y = currentYear; y >= 1960; y--){
      const opt = document.createElement('option');
      opt.value = String(y);
      opt.textContent = y;
      yearSel.appendChild(opt);
    }
  })();

  // basic form actions: build whatsapp message using form + cart from localStorage if exists
  (function setupForm(){
    const submitBtn = document.getElementById('submitBtn');
    const clearBtn = document.getElementById('clearBtn');

    submitBtn.addEventListener('click', function(){
      // collect fields
      const nickname = document.getElementById('nickname').value.trim();
      const day = document.getElementById('birth-day').value;
      const month = document.getElementById('birth-month').value;
      const year = document.getElementById('birth-year').value;
      const table = document.getElementById('table').value || '—';
      const phone = document.getElementById('phone').value.trim() || '—';
      const notes = document.getElementById('notes').value.trim() || '—';

      // optional: pull cart from localStorage (if you use neoCafe_cart_v1)
      let cart = [];
      try{
        const raw = localStorage.getItem('neoCafe_cart_v1');
        cart = raw ? JSON.parse(raw) : [];
      }catch(e){ cart = []; }

      // build message
      const lines = [];
      lines.push('طلب من Neo Café');
      if(nickname) lines.push(`اسم الشهرة: ${nickname}`);
      if(day || month || year){
        const dateText = `${day || '--'}/${month || '--'}/${year || '--'}`;
        lines.push(`تاريخ الميلاد: ${dateText}`);
      }
      lines.push(`رقم الطاولة: ${table}`);
      lines.push(`الهاتف: ${phone}`);
      lines.push('----------------------');

      if(cart && cart.length){
        lines.push('السلة:');
        cart.forEach((it, i) => {
          const qty = it.qty || 1;
          lines.push(`${i+1}. ${it.name} × ${qty} = ${ (Number(it.price)||0) * qty } ج`);
        });
      } else {
        lines.push('السلة فارغة أو لم تُحفظ عناصر.');
      }

      lines.push('----------------------');
      lines.push(`ملاحظات: ${notes}`);

      const text = encodeURIComponent(lines.join('\n'));
      const phoneTo = '201034311119'; // عدل الرقم لو تحتاجه
      window.open(`https://wa.me/${phoneTo}?text=${text}`, '_blank');
    });

    clearBtn.addEventListener('click', function(){
      if(!confirm('هل تريد فعلاً إفراغ الحقول؟')) return;
      document.getElementById('nickname').value = '';
      document.getElementById('birth-day').value = '';
      document.getElementById('birth-month').value = '';
      document.getElementById('birth-year').value = '';
      document.getElementById('table').value = '';
      document.getElementById('phone').value = '';
      document.getElementById('notes').value = '';
    });
  })();
</script>
</body>
</html>
